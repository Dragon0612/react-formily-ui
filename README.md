# React Formily UI å­¦ä¹ é¡¹ç›®

ä¸€ä¸ªå®Œæ•´çš„ Formily å­¦ä¹ ç¤ºä¾‹é¡¹ç›®ï¼ŒåŒ…å«ä»åŸºç¡€åˆ°è¿›é˜¶çš„å„ç§è¡¨å•ä½¿ç”¨åœºæ™¯ã€‚

## ğŸ“¦ æŠ€æœ¯æ ˆ

- **æ„å»ºå·¥å…·**: Vite 5.4
- **å‰ç«¯æ¡†æ¶**: React 18.3 + TypeScript
- **è¡¨å•æ–¹æ¡ˆ**: Formily 2.3
  - @formily/core - æ ¸å¿ƒé€»è¾‘
  - @formily/react - React æ¡¥æ¥
  - @formily/antd-v5 - Ant Design ç»„ä»¶é€‚é…
- **UI ç»„ä»¶åº“**: Ant Design 5.17
- **å›¾æ ‡**: @ant-design/icons

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
npm install
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€ http://localhost:3000

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
```

### é¢„è§ˆç”Ÿäº§æ„å»º

```bash
npm run preview
```

## ğŸ“š é¡¹ç›®ç»“æ„

```
react-formily-ui/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ BasicForm.tsx           # åŸºç¡€è¡¨å•ç¤ºä¾‹
â”‚   â”‚   â”œâ”€â”€ AdvancedForm.tsx        # é«˜çº§è¡¨å•ç¤ºä¾‹ï¼ˆè”åŠ¨ã€æŠ˜å é¢æ¿ï¼‰
â”‚   â”‚   â”œâ”€â”€ ArrayForm.tsx           # æ•°ç»„è¡¨å•ç¤ºä¾‹ï¼ˆè¡¨æ ¼ã€å¡ç‰‡ã€åˆ—è¡¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ ValidationForm.tsx      # è¡¨å•éªŒè¯ç¤ºä¾‹
â”‚   â”‚   â”œâ”€â”€ AsyncForm.tsx           # å¼‚æ­¥æ“ä½œç¤ºä¾‹
â”‚   â”‚   â”œâ”€â”€ CustomComponentForm.tsx # è‡ªå®šä¹‰ç»„ä»¶ç¤ºä¾‹
â”‚   â”‚   â””â”€â”€ RealWorldForm.tsx       # çœŸå®ä¸šåŠ¡åœºæ™¯ï¼ˆç”µå•†è®¢å•ï¼‰
â”‚   â”œâ”€â”€ App.tsx                     # ä¸»åº”ç”¨
â”‚   â”œâ”€â”€ main.tsx                    # å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ index.css                   # å…¨å±€æ ·å¼
â”œâ”€â”€ FORMILY_GUIDE.md                # Formily å­¦ä¹ æŒ‡å—
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ tsconfig.json
â””â”€â”€ README.md
```

## ğŸ¯ ç¤ºä¾‹è¯´æ˜

### 1. åŸºç¡€è¡¨å• (BasicForm.tsx)

å±•ç¤º Formily åŸºç¡€ç»„ä»¶çš„ä½¿ç”¨ï¼š
- Inputï¼ˆè¾“å…¥æ¡†ï¼‰
- Selectï¼ˆé€‰æ‹©å™¨ï¼‰
- DatePickerï¼ˆæ—¥æœŸé€‰æ‹©ï¼‰
- NumberPickerï¼ˆæ•°å­—è¾“å…¥ï¼‰
- Radioï¼ˆå•é€‰æ¡†ï¼‰
- Checkboxï¼ˆå¤é€‰æ¡†ï¼‰
- Switchï¼ˆå¼€å…³ï¼‰
- FormGridï¼ˆç½‘æ ¼å¸ƒå±€ï¼‰

**å­¦ä¹ è¦ç‚¹**ï¼š
- å¦‚ä½•åˆ›å»ºè¡¨å•å®ä¾‹
- å¦‚ä½•å®šä¹‰ Schema
- åŸºç¡€è¡¨å•ç»„ä»¶çš„ä½¿ç”¨
- è¡¨å•å¸ƒå±€æ–¹å¼

### 2. é«˜çº§è¡¨å• (AdvancedForm.tsx)

å±•ç¤ºé«˜çº§ç‰¹æ€§ï¼š
- è¡¨å•è”åŠ¨ï¼ˆå­—æ®µé—´ç›¸äº’å½±å“ï¼‰
- æŠ˜å é¢æ¿ï¼ˆFormCollapseï¼‰
- çº§è”é€‰æ‹©ï¼ˆCascaderï¼‰
- æ ‘å½¢é€‰æ‹©ï¼ˆTreeSelectï¼‰
- å¯†ç å¼ºåº¦æ ¡éªŒ

**å­¦ä¹ è¦ç‚¹**ï¼š
- ä½¿ç”¨ effects å®ç°å­—æ®µè”åŠ¨
- onFieldValueChange ç›‘å¬å­—æ®µå˜åŒ–
- å¤æ‚ç»„ä»¶çš„ä½¿ç”¨
- åŠ¨æ€æ§åˆ¶å­—æ®µçŠ¶æ€

### 3. æ•°ç»„è¡¨å• (ArrayForm.tsx)

å±•ç¤ºä¸‰ç§æ•°ç»„å­—æ®µå±•ç¤ºæ¨¡å¼ï¼š
- **ArrayTable** - è¡¨æ ¼æ¨¡å¼ï¼Œé€‚åˆå¤§é‡æ•°æ®å½•å…¥
- **ArrayCards** - å¡ç‰‡æ¨¡å¼ï¼Œé€‚åˆå¤æ‚å¯¹è±¡åˆ—è¡¨
- **ArrayItems** - åˆ—è¡¨æ¨¡å¼ï¼Œé€‚åˆç®€å•åˆ—è¡¨

**å­¦ä¹ è¦ç‚¹**ï¼š
- æ•°ç»„å­—æ®µçš„å®šä¹‰
- å¢åˆ æ”¹æŸ¥æ“ä½œ
- ä¸åŒå±•ç¤ºæ¨¡å¼çš„é€‰æ‹©
- æ•°ç»„é¡¹æ’åºåŠŸèƒ½

### 4. è¡¨å•éªŒè¯ (ValidationForm.tsx)

å±•ç¤ºå„ç§æ ¡éªŒåœºæ™¯ï¼š
- åŸºç¡€æ ¡éªŒï¼ˆå¿…å¡«ã€é•¿åº¦ã€æ­£åˆ™ï¼‰
- æ ¼å¼æ ¡éªŒï¼ˆé‚®ç®±ã€æ‰‹æœºå·ã€URLã€èº«ä»½è¯ï¼‰
- æ•°å­—æ ¡éªŒï¼ˆèŒƒå›´ã€ç²¾åº¦ï¼‰
- å¯†ç å¼ºåº¦æ ¡éªŒ
- æ—¥æœŸæ ¡éªŒ
- è‡ªå®šä¹‰æ ¡éªŒå‡½æ•°

**å­¦ä¹ è¦ç‚¹**ï¼š
- x-validator é…ç½®
- å†…ç½®æ ¡éªŒè§„åˆ™
- è‡ªå®šä¹‰æ ¡éªŒå™¨
- é”™è¯¯ä¿¡æ¯æç¤º

### 5. å¼‚æ­¥æ“ä½œ (AsyncForm.tsx)

å±•ç¤ºå¼‚æ­¥åœºæ™¯ï¼š
- å¼‚æ­¥æ•°æ®åŠ è½½
- å¼‚æ­¥æ ¡éªŒï¼ˆç”¨æˆ·åã€é‚®ç®±é‡å¤æ£€æµ‹ï¼‰
- çº§è”æ•°æ®åŠ è½½
- ä¾èµ–å­—æ®µè”åŠ¨

**å­¦ä¹ è¦ç‚¹**ï¼š
- onFormMount è¡¨å•æŒ‚è½½
- å¼‚æ­¥æ•°æ®æºè®¾ç½®
- Loading çŠ¶æ€ç®¡ç†
- å¼‚æ­¥æ ¡éªŒå®ç°

### 6. è‡ªå®šä¹‰ç»„ä»¶ (CustomComponentForm.tsx)

å±•ç¤ºå¦‚ä½•é›†æˆè‡ªå®šä¹‰ç»„ä»¶ï¼š
- ç®€å•åŒ…è£…ï¼ˆRateã€Sliderï¼‰
- æ ‡ç­¾é€‰æ‹©å™¨ï¼ˆæ”¯æŒé˜…è¯»æ€ï¼‰
- å›¾ç‰‡ä¸Šä¼ ç»„ä»¶
- æ–‡ä»¶æ‹–æ‹½ä¸Šä¼ 
- å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆç®€åŒ–ç‰ˆï¼‰

**å­¦ä¹ è¦ç‚¹**ï¼š
- connect è¿æ¥ç»„ä»¶
- observer å“åº”å¼åŒ…è£…
- mapReadPretty é˜…è¯»æ€
- è‡ªå®šä¹‰ç»„ä»¶å¼€å‘

### 7. çœŸå®ä¸šåŠ¡åœºæ™¯ (RealWorldForm.tsx)

å®Œæ•´çš„ç”µå•†è®¢å•æäº¤è¡¨å•ï¼š
- å•†å“æ¸…å•ç®¡ç†ï¼ˆArrayTableï¼‰
- æ”¶è´§ä¿¡æ¯å½•å…¥
- é…é€æ–¹å¼é€‰æ‹©
- æ”¯ä»˜æ–¹å¼é€‰æ‹©
- å‘ç¥¨ä¿¡æ¯ï¼ˆæ¡ä»¶æ˜¾ç¤ºï¼‰
- è®¢å•é‡‘é¢è‡ªåŠ¨è®¡ç®—
- æ»¡é¢åŒ…é‚®é€»è¾‘

**å­¦ä¹ è¦ç‚¹**ï¼š
- å¤æ‚è¡¨å•æ‹†åˆ†
- å¤š Tab è¡¨å•ç»„ç»‡
- å­—æ®µè”åŠ¨è®¡ç®—
- æ¡ä»¶æ˜¾ç¤º/éšè—
- å®æ—¶ç»Ÿè®¡æ±‡æ€»

## ğŸ“– å­¦ä¹ è·¯å¾„

1. **åˆå­¦è€…** â†’ ä»åŸºç¡€è¡¨å•å¼€å§‹ï¼Œäº†è§£ Formily çš„åŸºæœ¬æ¦‚å¿µå’Œç”¨æ³•
2. **è¿›é˜¶** â†’ å­¦ä¹ é«˜çº§è¡¨å•å’Œæ•°ç»„è¡¨å•ï¼ŒæŒæ¡å¤æ‚ç»„ä»¶çš„ä½¿ç”¨
3. **æ·±å…¥** â†’ ç ”ç©¶è¡¨å•éªŒè¯å’Œå¼‚æ­¥æ“ä½œï¼Œç†è§£æ ¡éªŒæœºåˆ¶å’Œå¼‚æ­¥å¤„ç†
4. **å®æˆ˜** â†’ å­¦ä¹ è‡ªå®šä¹‰ç»„ä»¶å’ŒçœŸå®ä¸šåŠ¡åœºæ™¯ï¼Œåº”ç”¨åˆ°å®é™…é¡¹ç›®

## ğŸ“ æ ¸å¿ƒæ¦‚å¿µ

### Formï¼ˆè¡¨å•æ¨¡å‹ï¼‰
è¡¨å•çš„æ ¸å¿ƒï¼Œç®¡ç†æ•´ä¸ªè¡¨å•çš„çŠ¶æ€ã€å€¼ã€æ ¡éªŒç­‰ã€‚

```typescript
const form = createForm({
  initialValues: { ... },  // åˆå§‹å€¼
  effects() { ... },        // å‰¯ä½œç”¨é€»è¾‘
  validateFirst: true,      // æ ¡éªŒé…ç½®
})
```

### Fieldï¼ˆå­—æ®µæ¨¡å‹ï¼‰
æ¯ä¸ªè¡¨å•é¡¹éƒ½æ˜¯ä¸€ä¸ª Fieldï¼ŒåŒ…å«å€¼ã€é”™è¯¯ã€åŠ è½½çŠ¶æ€ç­‰ã€‚

### Schemaï¼ˆè¡¨å•åè®®ï¼‰
JSON æ ¼å¼çš„è¡¨å•é…ç½®ï¼Œæè¿°è¡¨å•ç»“æ„å’Œè¡Œä¸ºã€‚

### SchemaField
å°† Schema æ¸²æŸ“æˆçœŸå®ç»„ä»¶çš„æ¡¥æ¥å™¨ã€‚

## ğŸ”¥ æ ¸å¿ƒç‰¹æ€§

### 1. è¡¨å•è”åŠ¨
é€šè¿‡ effects å®ç°å­—æ®µé—´çš„ç›¸äº’å½±å“ï¼š

```typescript
effects() {
  onFieldValueChange('field1', (field) => {
    const field2 = form.query('field2').take()
    field2.setValue(field.value * 2)
  })
}
```

### 2. å¼‚æ­¥æ ¡éªŒ
æ”¯æŒå¼‚æ­¥æ ¡éªŒï¼Œå¦‚æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ï¼š

```typescript
'x-validator': [
  {
    async validator(value) {
      const exists = await checkUsername(value)
      return exists ? 'ç”¨æˆ·åå·²å­˜åœ¨' : ''
    }
  }
]
```

### 3. æ¡ä»¶æ˜¾ç¤º
æ ¹æ®å…¶ä»–å­—æ®µçš„å€¼æ§åˆ¶å­—æ®µçš„æ˜¾ç¤º/éšè—ï¼š

```typescript
'x-reactions': {
  dependencies: ['userType'],
  fulfill: {
    state: {
      visible: '{{$deps[0] === "company"}}',
    }
  }
}
```

### 4. è‡ªåŠ¨è®¡ç®—
å­—æ®µå€¼å¯ä»¥åŸºäºå…¶ä»–å­—æ®µè‡ªåŠ¨è®¡ç®—ï¼š

```typescript
onFieldReact('total', (field) => {
  const price = form.values.price || 0
  const quantity = form.values.quantity || 1
  field.value = price * quantity
})
```

## ğŸ› ï¸ å¸¸ç”¨ API

### è¡¨å•æ“ä½œ
- `form.submit()` - æäº¤è¡¨å•
- `form.reset()` - é‡ç½®è¡¨å•
- `form.validate()` - æ ¡éªŒè¡¨å•
- `form.setValues()` - è®¾ç½®å€¼
- `form.getValues()` - è·å–å€¼

### å­—æ®µæ“ä½œ
- `field.setValue()` - è®¾ç½®å€¼
- `field.setLoading()` - è®¾ç½®åŠ è½½çŠ¶æ€
- `field.setPattern()` - è®¾ç½®æ¨¡å¼ï¼ˆeditable/disabled/readOnlyï¼‰
- `field.setDataSource()` - è®¾ç½®æ•°æ®æº
- `field.setErrors()` - è®¾ç½®é”™è¯¯

## ğŸ“š å‚è€ƒèµ„æº

- [Formily å®˜æ–¹æ–‡æ¡£](https://formilyjs.org/)
- [Formily GitHub](https://github.com/alibaba/formily)
- [Ant Design](https://ant.design/)
- [é¡¹ç›®å­¦ä¹ æŒ‡å—](./FORMILY_GUIDE.md)

## ğŸ’¡ æœ€ä½³å®è·µ

1. **è¡¨å•æ‹†åˆ†** - å¤§è¡¨å•æ‹†åˆ†ä¸ºå¤šä¸ªå°ç»„ä»¶ï¼Œæé«˜å¯ç»´æŠ¤æ€§
2. **Schema å¤ç”¨** - å°†å¸¸ç”¨çš„ Schema æå–ä¸ºå¯å¤ç”¨çš„é…ç½®
3. **æ ¡éªŒè§„åˆ™å¤ç”¨** - ç»Ÿä¸€ç®¡ç†æ ¡éªŒè§„åˆ™
4. **ç±»å‹å®šä¹‰** - ä½¿ç”¨ TypeScript å¢å¼ºç±»å‹å®‰å…¨
5. **é”™è¯¯å¤„ç†** - ç»Ÿä¸€å¤„ç†è¡¨å•é”™è¯¯å’Œæäº¤å¤±è´¥

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ License

MIT

---

**Happy Coding! ğŸ‰**


